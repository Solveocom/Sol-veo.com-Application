<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recharge Vélo Électrique</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="content" role="main">
    <h1>Recharge ton vélo électrique</h1>
    <p>Choisis une durée de recharge :</p>
    <select id="duration">
      <option value="1">1 minute</option>
      <option value="5">5 minutes</option>
      <option value="10">10 minutes</option>
    </select>

    <button id="activationButton" onclick="activerShelly()">Activer la recharge</button>
  </main>

  <script>
    async function activerShelly() {
      const duration = parseInt(document.getElementById("duration").value);

      try {
        // URL du serveur via Ngrok
        const res = await fetch('https://3015141bd6c2.ngrok-free.app/activate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ duration })
        });

        const data = await res.json();
        if (data.success) {
          alert(`Recharge activée pour ${duration} minutes !`);
        } else {
          alert(`Erreur : ${data.message}`);
        }
      } catch (err) {
        alert("Erreur lors de l’activation : " + err.message);
        console.error(err);
      }
    }
  </script>
</body>
</html>
